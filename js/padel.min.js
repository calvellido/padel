function Jugador(a){this.letra=a,this.nombre=a||"X",this.puntos=[],this.puntos[0]=this.puntos[1]=this.puntos[2]=this.puntos[3]=this.puntos[4]=this.puntos[5]=this.puntos[6]="",this.total_puntos=0,this.balance=[],this.balance[0]=this.balance[1]=this.balance[2]=this.balance[3]=this.balance[4]=this.balance[5]=this.balance[6]="",this.total_balance=0,this.victorias=0}$(document).ready(function(){cargarCruces(),cargarClasif(),$("#table_id").DataTable(),$("#tabla_cruces").DataTable(),$(".toggle-vis:input").on("change",function(a){a.preventDefault();var t=$("#table_id").DataTable().column($(this).attr("data-column"));t.visible(!t.visible()),$("th").unbind("click.DT")}),puntos_victoria=21,$("input[name='puntos_victoria']").TouchSpin({min:1,max:100,step:1,decimals:0,boostat:1,maxboostedstep:1,initval:21,buttondown_class:"btn btn-default btn-sm",buttonup_class:"btn btn-default btn-sm"}),$("input[name='puntos_victoria']").on("change",function(a){puntos_victoria=Number($(this).val()),calculo_todos(),$("#table_id").DataTable().destroy(),cargarClasif()})}),Jugador.prototype.calculo=function(){for(var a=0,t=0,r=0,o=0;o<this.puntos.length;++o)r+=Number(this.balance[o]),a+=Number(this.puntos[o]),this.puntos[o]===puntos_victoria&&t++;this.victorias=t,this.total_puntos=a,this.total_balance=r},Jugador.prototype.borrar_puntos=function(){for(var a=0;a<this.puntos.length;++a)this.balance[a]="",this.puntos[a]="";this.victorias=0,this.total_puntos=0,this.total_balance=0};var jugadores=[new Jugador("A"),new Jugador("B"),new Jugador("C"),new Jugador("D"),new Jugador("E"),new Jugador("F"),new Jugador("G"),new Jugador("H")],letras={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7};function calculo_todos(){for(var a=0;a<jugadores.length;++a)jugadores[a].calculo()}function borrar_puntos_todos(){for(var a=0;a<jugadores.length;++a)jugadores[a].borrar_puntos()}function Partido(a,t,r,o,e,s){this.ronda=a||0,this.cancha=t||0,this.jugador1=r,this.jugador2=o,this.jugador3=e,this.jugador4=s}Partido.prototype.crearFormulario=function(){var a=jugadores[letras[this.jugador1]].nombre,t=jugadores[letras[this.jugador2]].nombre,r=jugadores[letras[this.jugador3]].nombre,o=jugadores[letras[this.jugador4]].nombre,e=jugadores[letras[this.jugador1]].puntos[this.ronda-1],s=jugadores[letras[this.jugador3]].puntos[this.ronda-1];return"<form role='form' class='resultadoCruces'>\t\t\t\t<div class='form-group form-cruces'>\t\t\t\t\t<label class='col-xs-9 col-sm-6 control-label' for='_"+this.jugador1+this.jugador2+"_'>"+a+"/"+t+"</label>\t\t\t\t\t<div class='col-xs-3 col-sm-3'>\t\t\t\t\t\t<input class='form-control text-center' type='number' maxlength='2' size='3' data-ronda='"+this.ronda+"' data-rivales='"+this.jugador3+this.jugador4+"' id='_"+this.jugador1+this.jugador2+"_' value='"+e+"'>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<div class='form-group form-cruces'>\t\t\t\t\t<label class='col-xs-9 col-sm-6 control-label' for='_"+this.jugador3+this.jugador4+"_'>"+r+"/"+o+"</label>\t\t\t\t\t<div class='col-xs-3 col-sm-3'>\t\t\t\t\t\t<input class='form-control text-center' type='number' maxlength='2' size='3' data-ronda='"+this.ronda+"' data-rivales='"+this.jugador1+this.jugador2+"' id='_"+this.jugador3+this.jugador4+"_' value='"+s+"'>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</form>"};var partidos_normal=[new Partido(1,1,"A","B","C","D"),new Partido(1,2,"E","F","G","H"),new Partido(2,1,"A","C","E","G"),new Partido(2,2,"B","D","F","H"),new Partido(3,1,"B","C","F","G"),new Partido(3,2,"A","D","E","H"),new Partido(4,1,"A","E","B","F"),new Partido(4,2,"C","G","D","H"),new Partido(5,1,"B","E","D","G"),new Partido(5,2,"A","F","C","H"),new Partido(6,1,"B","H","C","E"),new Partido(6,2,"A","G","D","F"),new Partido(7,1,"C","F","D","E"),new Partido(7,2,"A","H","B","G")],partidos_wiseman=[new Partido(1,1,"H","G","F","C"),new Partido(1,2,"B","A","D","E"),new Partido(2,1,"G","D","H","E"),new Partido(2,2,"C","B","F","A"),new Partido(3,1,"H","C","E","B"),new Partido(3,2,"D","A","G","F"),new Partido(4,1,"E","G","B","F"),new Partido(4,2,"A","C","D","H"),new Partido(5,1,"A","E","C","G"),new Partido(5,2,"F","H","B","D"),new Partido(6,1,"C","D","G","B"),new Partido(6,2,"E","F","H","A"),new Partido(7,1,"D","F","E","C"),new Partido(7,2,"B","H","A","G")],torneo=partidos_normal;function cargarCruces(){$("#tabla_cruces").DataTable({paging:!1,searching:!1,info:!1,autoWidth:!0,data:torneo,columns:[{data:"ronda",visible:!1},{data:"cancha",width:"5px"},{data:null,render:"crearFormulario"}],order:[[0,"asc"],[1,"asc"],[2,"desc"]],drawCallback:function(a){var t=this.api(),r=t.rows({page:"current"}).nodes(),o=null;t.column(0,{page:"current"}).data().each(function(a,t){o!==a&&($(r).eq(t).before('<td class="grupo-ronda" colspan="3">Ronda '+a+"<td></td></td>"),o=a)})}}),$("th").unbind("click.DT")}function cargarClasif(){$("#table_id").DataTable({paging:!1,searching:!1,info:!1,data:jugadores,columns:[{data:"nombre"},{data:"victorias"},{data:"total_balance",render:function(a,t,r){return a<1?a:"+"+a}},{data:"total_puntos",visible:!1}],order:[[1,"desc"],[2,"desc"],[3,"desc"]]}),$("th").unbind("click.DT")}function cambiarTorneo(a){torneo="torneo_normal"===a?partidos_normal:partidos_wiseman,borrar_puntos_todos(),$("#tabla_cruces").DataTable().destroy(),cargarCruces(),$("#table_id").DataTable().destroy(),cargarClasif()}function sortearOrden(){for(var a=Math.floor(8*Math.random())+8,t=0;t<a;++t){var r=Math.floor(8*Math.random()),o=Math.floor(8*Math.random()),e=jugadores[r].nombre;jugadores[r].nombre=jugadores[o].nombre,jugadores[o].nombre=e}borrar_puntos_todos(),$("#tabla_cruces").DataTable().destroy(),cargarCruces(),$("#table_id").DataTable().destroy(),cargarClasif()}function cambiarPistas(){for(var a=1;a<jugadores.length;++a){var t=torneo.filter(function(t){return t.ronda===a}),r=t[0].cancha;t[0].cancha=t[1].cancha,t[1].cancha=r}borrar_puntos_todos(),$("#tabla_cruces").DataTable().destroy(),cargarCruces(),$("#table_id").DataTable().destroy(),cargarClasif()}function resetear(){for(var a=0;a<jugadores.length;++a)jugadores[a].nombre=$("#registro input[name='"+a+"']").val();for(a=1;a<jugadores.length;++a){var t=torneo.filter(function(t){return t.ronda===a});t[0].cancha=1,t[1].cancha=2}borrar_puntos_todos(),$("#tabla_cruces").DataTable().destroy(),cargarCruces(),$("#table_id").DataTable().destroy(),cargarClasif()}$("#registro").on("change",":input",function(){$(this).attr("id"),$(this).attr("name");var a=$(this).attr("data-initial-value"),t=$(this).val();jugadores.filter(function(t){return t.nombre===a})[0].nombre=t,$(this).attr("data-initial-value",t),$("#table_id").DataTable().destroy(),cargarClasif(),$("#tabla_cruces").DataTable().destroy(),cargarCruces()}),$("#tabla_cruces").on("change",":input",function(){var a=$(this).attr("id").charAt(1),t=$(this).attr("id").charAt(2),r=parseInt($(this).data("ronda"),10),o=parseInt($(this).val(),10),e=$(this).data("rivales").charAt(0),s=$(this).data("rivales").charAt(1),n=o-Number(jugadores[letras[e]].puntos[r-1]);jugadores[letras[a]].puntos[r-1]=o||"",jugadores[letras[t]].puntos[r-1]=o||"",jugadores[letras[a]].balance[r-1]=n,jugadores[letras[t]].balance[r-1]=n,jugadores[letras[e]].balance[r-1]=-n,jugadores[letras[s]].balance[r-1]=-n,jugadores[letras[a]].calculo(),jugadores[letras[t]].calculo(),jugadores[letras[e]].calculo(),jugadores[letras[s]].calculo(),$("#table_id").DataTable().destroy(),cargarClasif()}),$(function(){$(".tipo_torneo .btn").click(function(){cambiarTorneo($(this).children("input").attr("id"))}),$("#sortear").click(function(){sortearOrden()}),$("#pistas").click(function(){cambiarPistas()}),$("#resetear").click(function(){resetear()})}),$("#cruces").on("submit",".resultadoCruces",function(){return!1}),$(window).scroll(function(a){$(".navbar").offset().top>25?$(".navbar").hasClass("shadow")||$(".navbar").addClass("shadow"):$(".navbar").removeClass("shadow")}),$(".navbar a").on("click",function(){$(".navbar-toggle").is(":visible")&&$(".navbar-nav").is(":visible")&&$(".navbar-toggle").click()}),$(document).on("click",'a[href^="#"]',function(a){a.preventDefault();var t=$(this).attr("href");$("html, body").stop().animate({scrollTop:$(t).offset().top},600)});